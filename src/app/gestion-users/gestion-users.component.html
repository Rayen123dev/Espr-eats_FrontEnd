<!-- Sidebar -->
<div class="deznav">
  <div class="deznav-scroll">
    <a class="add-project-sidebar btn btn-primary" href="javascript:void(0)" data-bs-toggle="modal" data-bs-target="#addProjectSidebar">+ New Project</a>
    <ul class="metismenu" id="menu">
      <li><a href="#">
          <i class="flaticon-layout"></i>
          <span class="nav-text">Dashboard</span>
        </a>
      </li>
      <li><a href="#">
          <i class="flaticon-monitor"></i>
          <span class="nav-text">Apps</span>
        </a>
      </li>
      <li><a href="#">
          <i class="flaticon-bar-chart-1"></i>
          <span class="nav-text">Charts</span>
        </a>
      </li>
      <li><a href="#">
          <i class="flaticon-web"></i>
          <span class="nav-text">Bootstrap</span>
        </a>
      </li>
      <li><a href="#">
          <i class="flaticon-plugin"></i>
          <span class="nav-text">Plugins</span>
        </a>
      </li>
      <li><a href="#">
          <i class="flaticon-admin"></i>
          <span class="nav-text">Widget</span>
        </a>
      </li>
      <li><a href="#">
          <i class="flaticon-contract"></i>
          <span class="nav-text">Forms</span>
        </a>
      </li>
      <li><a href="#">
          <i class="flaticon-table"></i>
          <span class="nav-text">Table</span>
        </a>
      </li>
      <li><a href="#">
          <i class="flaticon-newsletter"></i>
          <span class="nav-text">Pages</span>
        </a>
      </li>
    </ul>
  </div>
</div>
<!--**********************************
    Sidebar end
***********************************-->

<!--**********************************
    Content body start
***********************************-->
<div class="content-body">
  <div class="container-fluid">
    <!-- User Profile Card -->
    <div class="col-xl-12">
      <div class="card overflow-hidden">
        <div class="card-body">
          <div class="text-center">
            <div class="profile-photo">
              <img [src]="userProfileImage" width="100" class="img-fluid rounded-circle" alt="User Profile">
            </div>
            <h3 class="mt-4 mb-1">{{userName}}</h3>
            <p class="text-muted">{{userRole}}</p>
            <a class="btn btn-outline-primary btn-rounded mt-3 px-5" href="javascript:void(0)">Follow</a>
          </div>
        </div>

        <div class="card-footer pt-0 pb-0 text-center">
          <div class="row">
            <div class="col-4 pt-3 pb-3 border-right">
              <h3 class="mb-1">150</h3><span>Follower</span>
            </div>
            <div class="col-4 pt-3 pb-3 border-right">
              <h3 class="mb-1">140</h3><span>Place Stay</span>
            </div>
            <div class="col-4 pt-3 pb-3">
              <h3 class="mb-1">45</h3><span>Reviews</span>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Stats Cards -->
    <div class="row">
      <!-- Total Users -->
      <div class="col-xl-3 col-xxl-3 col-lg-6 col-sm-6">
        <div class="card card-bd">
          <div class="bg-secondary card-border" style="background:#3444d5 !important;"></div>
          <div class="card-body box-style">
            <div class="media align-items-center">
              <div class="media-body me-3">
                <h2 class="count num-text text-black font-w700">{{nbUsersT}}</h2>
                <span class="fs-14">Nombre utilisateur</span>
              </div>
              <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M34.422 13.9831C34.3341 13.721 34.1756 13.4884 33.9638 13.3108C33.7521 13.1332 33.4954 13.0175 33.222 12.9766L23.649 11.5141L19.353 2.36408C19.2319 2.10638 19.0399 1.88849 18.7995 1.73587C18.5591 1.58325 18.2803 1.5022 17.9955 1.5022C17.7108 1.5022 17.4319 1.58325 17.1915 1.73587C16.9511 1.88849 16.7592 2.10638 16.638 2.36408L12.342 11.5141L2.76902 12.9766C2.49635 13.0181 2.24042 13.1341 2.02937 13.3117C1.81831 13.4892 1.6603 13.7215 1.57271 13.9831C1.48511 14.2446 1.47133 14.5253 1.53287 14.7941C1.59441 15.063 1.72889 15.3097 1.92152 15.5071L8.89802 22.6501L7.24802 32.7571C7.20299 33.0345 7.23679 33.3189 7.34555 33.578C7.45431 33.8371 7.63367 34.0605 7.86319 34.2226C8.09271 34.3847 8.36315 34.4791 8.64371 34.495C8.92426 34.5109 9.20365 34.4477 9.45002 34.3126L18 29.5906L26.55 34.3126C26.7964 34.4489 27.0761 34.5131 27.3573 34.4978C27.6384 34.4826 27.9096 34.3885 28.1398 34.2264C28.37 34.0643 28.5499 33.8406 28.659 33.5811C28.768 33.3215 28.8018 33.0365 28.7565 32.7586L27.1065 22.6516L34.0785 15.5071C34.2703 15.3091 34.4037 15.0622 34.4643 14.7933C34.5249 14.5245 34.5103 14.2441 34.422 13.9831Z"
                  fill="#864AD1" />
              </svg>
            </div>
          </div>
        </div>
      </div>
      <!-- Students -->
      <div class="col-xl-3 col-xxl-3 col-lg-6 col-sm-6">
        <div class="card card-bd">
          <div class="bg-warning card-border"></div>
          <div class="card-body box-style">
            <div class="media align-items-center">
              <div class="media-body me-3">
                <h2 class="count num-text text-black font-w700">{{nbUsers}}</h2>
                <span class="fs-14">Nombre etudiant</span>
              </div>
              <svg width="36" height="36" viewBox="0 0 36 36" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M17.8935 22.5C23.6925 22.5 28.3935 17.799 28.3935 12C28.3935 6.20101 23.6925 1.5 17.8935 1.5C12.0945 1.5 7.39351 6.20101 7.39351 12C7.39351 17.799 12.0945 22.5 17.8935 22.5Z"
                  fill="#FFB930" />
                <path
                  d="M29.5605 21.3344C29.217 20.9909 28.851 20.6699 28.476 20.3564C27.2159 21.96 25.6078 23.2562 23.7733 24.1472C21.9388 25.0382 19.9259 25.5007 17.8864 25.4996C15.847 25.4986 13.8345 25.0342 12.0009 24.1414C10.1673 23.2486 8.56051 21.9507 7.30199 20.3459C5.447 21.8906 3.95577 23.8256 2.9347 26.013C1.91364 28.2003 1.3879 30.586 1.39499 32.9999C1.39499 33.3978 1.55303 33.7793 1.83433 34.0606C2.11564 34.3419 2.49717 34.4999 2.89499 34.4999H32.895C33.2928 34.4999 33.6743 34.3419 33.9557 34.0606C34.237 33.7793 34.395 33.3978 34.395 32.9999C34.4004 30.8324 33.9759 28.6854 33.146 26.683C32.3162 24.6807 31.0975 22.8627 29.5605 21.3344Z"
                  fill="#FFB930" />
              </svg>
            </div>
          </div>
        </div>
      </div>
      <!-- Admins -->
      <div class="col-xl-3 col-xxl-3 col-lg-6 col-sm-6">
        <div class="card card-bd">
          <div class="bg-primary card-border"></div>
          <div class="card-body box-style">
            <div class="media align-items-center">
              <div class="media-body me-3">
                <h2 class="count num-text text-black font-w700">{{nbAdmins}}</h2>
                <span class="fs-14">Nombre Admin</span>
              </div>
              <svg class="primary-icon" width="36" height="36" viewBox="0 0 36 36" fill="none"
                xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M11.9999 1.5H5.99994C3.51466 1.5 1.49994 3.51472 1.49994 6V29.8125C1.49994 32.2977 3.51466 34.3125 5.99994 34.3125H11.9999C14.4852 34.3125 16.4999 32.2977 16.4999 29.8125V6C16.4999 3.51472 14.4852 1.5 11.9999 1.5Z"
                  fill="#20F174" />
                <path
                  d="M30 1.5H24C21.5147 1.5 19.5 3.51472 19.5 6V12C19.5 14.4853 21.5147 16.5 24 16.5H30C32.4853 16.5 34.5 14.4853 34.5 12V6C34.5 3.51472 32.4853 1.5 30 1.5Z"
                  fill="#20F174" />
                <path
                  d="M30 19.5H24C21.5147 19.5 19.5 21.5147 19.5 24V30C19.5 32.4853 21.5147 34.5 24 34.5H30C32.4853 34.5 34.5 32.4853 34.5 30V24C34.5 21.5147 32.4853 19.5 30 19.5Z"
                  fill="#20F174" />
              </svg>
            </div>
          </div>
        </div>
      </div>
      <!-- Doctors -->
      <div class="col-xl-3 col-xxl-3 col-lg-6 col-sm-6">
        <div class="card card-bd">
          <div class="bg-info card-border"></div>
          <div class="card-body box-style">
            <div class="media align-items-center">
              <div class="media-body me-3">
                <h2 class="count num-text text-black font-w700">{{nbMedecins}}</h2>
                <span class="fs-14">Nombre Medcin</span>
              </div>
              <svg width="46" height="46" viewBox="0 0 46 46" fill="none" xmlns="http://www.w3.org/2000/svg">
                <path
                  d="M34.4999 1.91663H11.4999C8.95917 1.91967 6.52338 2.93032 4.72682 4.72688C2.93026 6.52345 1.91961 8.95924 1.91656 11.5V26.8333C1.91935 29.0417 2.6834 31.1816 4.07994 32.8924C5.47648 34.6031 7.42011 35.7801 9.58323 36.225V42.1666C9.58318 42.5136 9.67733 42.8541 9.85564 43.1518C10.0339 43.4495 10.2897 43.6932 10.5957 43.8569C10.9016 44.0206 11.2463 44.0982 11.5932 44.08C11.9402 44.0617 12.275 43.9483 12.5632 43.7516L23.9999 36.4166L35.4366 43.7516C35.7248 43.9483 36.0596 44.0617 36.4066 44.08C36.7535 44.0982 37.0982 44.0206 37.4041 43.8569C37.7101 43.6932 37.9658 43.4495 38.1441 43.1518C38.3225 42.8541 38.4166 42.5136 38.4166 42.1666V36.225C40.5797 35.7801 42.5233 34.6031 43.9199 32.8924C45.3164 31.1816 46.0805 29.0417 46.0832 26.8333V11.5C46.0802 8.95924 45.0695 6.52345 43.273 4.72688C41.4764 2.93032 39.0406 1.91967 36.4999 1.91663H34.4999Z"
                  fill="#3ECDFF" />
              </svg>
            </div>
          </div>
        </div>
      </div>
    </div>

    <!-- Chart Stats Row -->
    <div class="row">
      <!-- User Distribution Chart -->
      <div class="col-xl-6 col-lg-6">
        <div class="card">
          <div class="card-header">
            <h4 class="card-title">Distribution des utilisateurs</h4>
          </div>
          <div class="card-body">
            <div id="userDistributionChart" class="ct-chart ct-perfect-fourth"></div>
          </div>
        </div>
      </div>
      <!-- Reclamation Status Chart -->
      <div class="col-xl-6 col-lg-6">
        <div class="card">
          <div class="card-header">
            <h4 class="card-title">Statut des réclamations</h4>
          </div>
          <div class="card-body">
            <div id="reclamationStatusChart" class="ct-chart ct-perfect-fourth"></div>
          </div>
        </div>
      </div>
    </div>

    <!-- Additional Charts Row -->
    <div class="row">
      <!-- Monthly Reclamations Chart -->
      <div class="col-xl-6 col-lg-6">
        <div class="card">
          <div class="card-header">
            <h4 class="card-title">Réclamations mensuelles</h4>
          </div>
          <div class="card-body">
            <div id="monthlyReclamationsChart" class="ct-chart ct-perfect-fourth"></div>
          </div>
        </div>
      </div>
      <!-- Weekly Trends Chart -->
      <div class="col-xl-6 col-lg-6">
        <div class="card">
          <div class="card-header">
            <h4 class="card-title">Tendances hebdomadaires</h4>
          </div>
          <div class="card-body">
            <div id="weeklyTrendsChart" class="ct-chart ct-perfect-fourth"></div>
          </div>
        </div>
      </div>
    </div>

    <div class="row">
      <div class="col-xl-6 col-xxl-12">
        <div class="card">
          <div class="card-header d-block border-0 pb-0">
            <div class="d-flex justify-content-between pb-3">
              <h4 class="mb-0 text-black fs-20">Liste des ulisateurs</h4>
              <div class="filter-actions">
                <button 
                  (click)="filterUser('ALL')" 
                  [class.active]="statusFilter === 'ALL'"
                  class="filter-btn"
                >
                  Toutes
                </button>
                <button 
                  (click)="filterUser('Admin')" 
                  [class.active]="statusFilter === 'Admin'"
                  class="filter-btn"
                >
                  Admin
                </button>
                <button 
                  (click)="filterUser('User')" 
                  [class.active]="statusFilter === 'User'"
                  class="filter-btn"
                >
                  User
                </button>
                <button 
                  (click)="filterUser('Staff')" 
                  [class.active]="statusFilter === 'Staff'"
                  class="filter-btn"
                >
                Staff
                </button>
                <button 
                  (click)="filterUser('Medcin')" 
                  [class.active]="statusFilter === 'Medcin'"
                  class="filter-btn"
                >
                Medcin
                </button>
              </div>
            </div>
          </div>
          <!-- Integrated User Table -->
          <div class="card-body table-responsive">
          <input
            type="text"
            placeholder="Search by name..."
            [(ngModel)]="searchQuery"
            (input)="onSearchChange()"
            class="search-input"
          />
            <table class="table table-hover">
              <thead class="text-warning">
                <th>ID</th>
                <th>Name</th>
                <th>Email</th>
                <th>Status</th>
                <th>Role</th>
                <th>Actions</th>
              </thead>
              <tbody>
                <tr *ngFor="let user of filteredUsers">
                  <td>{{user.idUser}}</td>
                  <td>{{user.nom}}</td>
                  <td>{{user.email}}</td>
                  <td>
                  </td>
                  <td>{{user.role}}</td>
                  <td>
                  <button class="btn btn-icon btn-distrry" (click)="BloquerUser(user.idUser)" title="Résoudre">
                    <i class="fas fa-check-circle"></i>
                  </button>
                  <button class="btn btn-icon btn-bloc" (click)="ActiverUser(user.idUser)" title="Résoudre">
                    <i class="fas fa-check-circle"></i>
                  </button>
                </td>
                </tr>
              </tbody>
            </table>
            <mat-paginator
  [length]="totalItems"
  [pageSize]="pageSize"
  [pageSizeOptions]="[5, 10, 25, 50]"
  (page)="onPageChange($event)">
</mat-paginator>
          </div>
        </div>
      </div>
      <div class="row">
        <div class="col-xl-12">
          <div class="card">
            <div class="card-header d-block border-0 pb-0">
              <div class="d-flex justify-content-between pb-3">
                <h4 class="mb-0 text-black fs-20">Liste des reclamations</h4>
              </div>
            </div>
            <!-- Reclamation Table -->
            <div class="card-body table-responsive">
              <table class="table table-hover">
                <thead class="text-danger">
                  <th>ID</th>
                  <th>Sujet</th>
                  <th>Description</th>
                  <th>Date</th>
                  <th>Status</th>
                  <th>Utilisateur</th>
                  <th>Actions</th>
                </thead>
                <tbody>
                  <tr *ngFor="let reclamation of reclamations">
                    <td>{{reclamation.id}}</td>
                    <td>{{reclamation.subject}}</td>
                    <td>{{reclamation.description.length > 30 ? reclamation.description.substring(0, 30) + '...' : reclamation.description}}</td>
                    <td>{{reclamation.dateCreated | date:'short'}}</td>
                    <td>
                      <span [ngClass]="{
                        'badge badge-danger': reclamation.status === 'PENDING',
                        'badge badge-warning': reclamation.status === 'IN_PROGRESS',
                        'badge badge-success': reclamation.status === 'RESOLVED'
                      }">{{reclamation.status}}</span>
                    </td>
                    <td>{{reclamation.user?.nom || 'N/A'}}</td>
                    <td class="actions">
                      <button class="btn btn-icon btn-resolve" (click)="resolveReclamation(reclamation.id)" title="Résoudre">
                        <i class="fas fa-check-circle"></i>
                      </button>
                      <button class="btn btn-icon btn-close" (click)="closeReclamation(reclamation.id)" title="Fermer">
                        <i class="fas fa-times-circle"></i>
                      </button>
                    </td>
                  </tr>
                </tbody>
              </table>
            </div>
          </div>
        </div>
      </div>
  </div>
</div>
<!--**********************************
    Content body end
***********************************-->