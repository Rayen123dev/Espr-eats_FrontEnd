<div class="subscription-container">
  <h6 class="pricing-smalltitle"><span>get started today .</span></h6>
  <h2 class="pricing-title">Plans & Pricing</h2>

  <p class="greeting-message">Bienvenue ! D√©couvrez nos offres excitantes et choisissez le plan parfait pour booster votre exp√©rience d√®s aujourd'hui !</p>

  <!-- Black Friday Component -->
  <div *ngIf="showBlackFriday" class="black-friday-component" role="region" aria-label="Black Friday Discount">
    <div class="coupon" aria-describedby="discount-desc">
      <div class="box"><span>{{ getMaxDiscount().replace(' OFF', '') }}</span><span>OFF</span></div>
      <div class="diver"></div>
      <div class="content">
        <h3>
          <span>L</span><span>I</span><span>M</span><span>I</span><span>T</span><span>E</span><span class="end">D</span>
          <span>O</span><span>F</span><span>F</span><span>E</span><span>R</span><span>üéâ</span>
        </h3>
        <p id="discount-desc">
          The Limited Time Offer deal is back with <strong>{{ getMaxDiscount() }}</strong> on all abonnements! 
          <span *ngIf="days !== '00'; else expired">
            Only <strong>{{ days }} days</strong> left until April 16, 2025!
          </span>
          <ng-template #expired>
            Offer has expired.
          </ng-template>
        </p>
      </div>
    </div>
    <div class="timer" role="timer" aria-live="polite">
      <div class="item">
        <div class="days"><div class="day"><span>{{ days }}</span></div></div>
        <p>day</p>
      </div>
      <span class="colon">:</span>
      <div class="item">
        <div class="hours"><div class="hour"><span>{{ hours }}</span></div></div>
        <p>hour</p>
      </div>
      <span class="colon">:</span>
      <div class="item">
        <div class="minutes"><div class="min"><span>{{ minutes }}</span></div></div>
        <p>min</p>
      </div>
      <span class="colon">:</span>
      <div class="item">
        <div class="seconds"><div class="sec"><span>{{ seconds }}</span></div></div>
        <p>sec</p>
      </div>
    </div>
  </div>

  
  <!-- Toast Notification -->
  <div *ngIf="showToast" class="custom-toast" [ngClass]="{'toast-danger': toastTitle === 'Danger', 'toast-warning': toastTitle === 'Warning'}" role="alert">
    <div class="toast-body">
      {{ toastMessage }}
    </div>
    <button type="button" class="toast-close" (click)="closeToast()" aria-label="Close">√ó</button>
  </div>

  <div id="plans-container" class="plans-container">
    <div *ngFor="let plan of subscriptionPlans; let i = index" class="plan-card" [class.most-popular]="plan.isRecommended">
      <!-- Most Popular Badge -->
      <div *ngIf="plan.isRecommended" class="most-popular-badge">
        <span class="crown-icon">üëë</span> Most Popular !
      </div>

      <!-- Discount Badge -->
      <div *ngIf="plan.discount" class="discount-badge">
        -{{ plan.discount.replace(' off', '') }}
      </div>

      <h3>{{ plan.type | titlecase }}</h3>
      <p class="description">{{ plan.description }}</p>

      <!-- Add specific information about the subscription type -->
      <p class="subscription-info">
        <ng-container [ngSwitch]="plan.type">
          <ng-container *ngSwitchCase="'MENSUEL'">
            Id√©al pour les utilisateurs occasionnels. Profitez d'une flexibilit√© totale avec un abonnement mensuel sans engagement √† long terme.
          </ng-container>
          <ng-container *ngSwitchCase="'TRIMESTRIEL'">
            Parfait pour les utilisateurs r√©guliers. B√©n√©ficiez de 3 mois d'acc√®s continu avec une r√©duction <br/>avantageuse.
          </ng-container>
          <ng-container *ngSwitchCase="'SEMESTRIEL'">
            Con√ßu pour les utilisateurs engag√©s. Profitez de 6 mois d'abonnement avec une remise encore plus <br/>int√©ressante.
          </ng-container>
          <ng-container *ngSwitchCase="'ANNUEL'">
            La meilleure option pour les utilisateurs intensifs. Acc√©dez √† un an complet avec notre meilleure offre et √©conomisez davantage !
          </ng-container>
        </ng-container>
      </p>

      <!-- Display total cost and billing period -->
      <div class="price">
        <!-- Show original price with strikethrough if there's a discount -->
        <span *ngIf="plan.discount" class="original-price">{{ plan.originalCost.toFixed(2) }} Dt</span>
        <!-- Show discounted price (or original if no discount) -->
        <div class="price-line">
          <span class="current-price">{{ plan.cost.toFixed(2) }} Dt</span>
          <span *ngIf="plan.type !== 'MENSUEL'" class="monthly-cost">/{{ plan.type === 'ANNUEL' ? 'year' : plan.type === 'SEMESTRIEL' ? '6 months' : 'quarter'}}</span>
        </div>
        <span class="billing-note">{{ plan.type === 'MENSUEL' ? 'Billed monthly' : 'Billed ' + (plan.type === 'ANNUEL' ? 'yearly' : plan.type === 'SEMESTRIEL' ? 'semi-annually' : 'quarterly') }}</span>
      </div>

      <!-- Display user count if available -->
      <p *ngIf="plan.userCount" class="user-count">Choisi par {{ plan.userCount }} utilisateurs</p>

      <div class="renewal-option">
        <label class="toggle-switch" title="Activer le renouvellement automatique pour renouveler votre abonnement √† la fin de la p√©riode">
          <span class="toggle-label off"></span>
          <input type="checkbox" [(ngModel)]="plan.renouvellementAutomatique" [ngModelOptions]="{standalone: true}">
          <span class="toggle-slider"></span>
          <span class="toggle-label on">renouvellement</span>
        </label>
      </div>

      <button class="subscribe-button" (click)="createSubscription(plan.type, plan.cost, plan.renouvellementAutomatique)">
        Choisir Plan
      </button>

      <p class="user-limit">Up to {{ plan.type === 'MENSUEL' ? '1,000' : plan.type === 'TRIMESTRIEL' ? '5,000' : plan.type === 'SEMESTRIEL' ? '10,000' : '25,000' }} users</p>
    </div>
  </div>
</div>