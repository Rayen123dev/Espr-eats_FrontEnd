<!-- Sidebar Section -->
<div class="deznav">
  <div class="deznav-scroll">
    <a class="add-project-sidebar btn btn-primary" href="javascript:void(0)" data-bs-toggle="modal" data-bs-target="#addProjectSidebar">+ Nouveau Projet</a>
    <ul class="metismenu" id="menu">
      <li><a href="#">
        <i class="flaticon-layout"></i>
        <span class="nav-text">Tableau de Bord</span>
      </a></li>
      <li><a href="#">
        <i class="flaticon-monitor"></i>
        <span class="nav-text">Applications</span>
      </a></li>
      <li><a href="#">
        <i class="flaticon-bar-chart-1"></i>
        <span class="nav-text">Graphiques</span>
      </a></li>
      <li><a href="#">
        <i class="flaticon-web"></i>
        <span class="nav-text">Bootstrap</span>
      </a></li>
      <li><a routerLink="/produits-dashboard" routerLinkActive="active">
        <i class="flaticon-plugin"></i>
        <span class="nav-text">Produits</span>
      </a></li>
      <li><a href="#">
        <i class="flaticon-admin"></i>
        <span class="nav-text">Widgets</span>
      </a></li>
      <li><a href="#">
        <i class="flaticon-contract"></i>
        <span class="nav-text">Formulaires</span>
      </a></li>
      <li><a href="#">
        <i class="flaticon-table"></i>
        <span class="nav-text">Tableaux</span>
      </a></li>
      <li><a href="#">
        <i class="flaticon-newsletter"></i>
        <span class="nav-text">Pages</span>
      </a></li>
    </ul>
  </div>
</div>

<!-- Dashboard Content Section -->
<div class="dashboard-wrapper">
  <div class="dashboard-container">
    <div class="dashboard-header">
      <h1 class="dashboard-title"><i class="fas fa-chart-line"></i> Tableau de Bord des Produits</h1>
      <div class="dashboard-actions">
        <button (click)="goToProductList()">
          <i class="fas fa-boxes"></i> Voir Tous les Produits
        </button>
      </div>
    </div>

    <div class="stats-grid">
      <!-- Total Products Card -->
      <div class="stat-card total-products">
        <i class="fas fa-boxes-stacked icon-large"></i>
        <div class="stat-title">Produits Totaux</div>
        <h2 class="stat-value">{{ totalProductCount }}</h2>
        <div class="stat-info">Produits enregistrés</div>
        <div class="progress-bar">
          <div class="progress-fill fill-total" [style.width]="'100%'"></div>
        </div>
      </div>

      <!-- Average Stock Level Card -->
      <div class="stat-card avg-stock">
        <i class="fas fa-chart-bar icon-large"></i>
        <div class="stat-title">Niveau de Stock Moyen</div>
        <h2 class="stat-value">{{ averageStockLevel }}</h2>
        <div class="stat-info">Unités par produit</div>
        <div class="progress-bar">
          <div class="progress-fill fill-avg" [style.width]="(averageStockLevel / 100 * 100) + '%'"></div>
        </div>
      </div>

      <!-- Low Stock Card -->
      <div class="stat-card low-stock">
        <i class="fas fa-triangle-exclamation icon-large"></i>
        <div class="stat-title">Stock Faible</div>
        <h2 class="stat-value">{{ lowStockCount }}</h2>
        <div class="stat-info">Produits en stock limité</div>
        <div class="progress-bar">
          <div class="progress-fill fill-low" [style.width]="(lowStockCount / totalProductCount * 100) + '%'"></div>
        </div>
      </div>

      <!-- Out of Stock Card -->
      <div class="stat-card out-of-stock">
        <i class="fas fa-ban icon-large"></i>
        <div class="stat-title">Rupture de Stock</div>
        <h2 class="stat-value">{{ outOfStockCount }}</h2>
        <div class="stat-info">Produits indisponibles</div>
        <div class="progress-bar">
          <div class="progress-fill fill-out" [style.width]="(outOfStockCount / totalProductCount * 100) + '%'"></div>
        </div>
      </div>

      <!-- Expired Products Card -->
      <div class="stat-card expired">
        <i class="fas fa-skull-crossbones icon-large"></i>
        <div class="stat-title">Produits Expirés</div>
        <h2 class="stat-value">{{ expiredProductCount }}</h2>
        <div class="stat-info">À retirer du stock</div>
        <div class="progress-bar">
          <div class="progress-fill fill-expired" [style.width]="(expiredProductCount / totalProductCount * 100) + '%'"></div>
        </div>
      </div>
    </div>

    <!-- Near Expiry Products Section -->
    <div class="expiry-section">
      <div class="expiry-header">
        <h3 class="expiry-title"><i class="fas fa-hourglass-half"></i> Produits Proches de l'Expiration</h3>
      </div>
      <ul class="expiry-list">
        <li class="expiry-item" *ngFor="let product of nearExpiryProducts">
          <div class="product-info">
            <i class="fas fa-box-open"></i>
            <span class="product-name">{{ product.nomProduit }}</span>
            <span class="product-code">({{ product.barcode }})</span>
          </div>
          <span class="days-label" [class.critical]="getDaysUntilExpiry(product) <= 3">
            {{ getDaysUntilExpiry(product) }} jours
          </span>
        </li>

        <li class="expiry-item" *ngIf="nearExpiryProducts.length === 0">
          <div class="product-info">
            <i class="fas fa-check-circle"></i>
            <span class="product-name">Aucun produit proche de l'expiration</span>
          </div>
        </li>
      </ul>
    </div>
  </div>
</div>
