<div class="menu-dashboard-container">
  <div class="dashboard-header">
    <div class="header-content">
      <h1 class="dashboard-title">Gestion des Menus</h1>
      <div class="dashboard-actions">
        <button 
          *ngIf="userRole === 'Staff'" 
          class="btn btn-generate" 
          (click)="generateMenus()"
          [disabled]="isLoading || !canGenerateMenus()">
          <i class="icon-generate"></i>
          {{ isLoading ? 'Génération en cours...' : 'Générer les menus' }}
        </button>
        
        <button 
          *ngIf="userRole === 'Staff'" 
          class="btn btn-regenerate" 
          (click)="regenerateMenus()"
          [disabled]="isLoading || !canGenerateMenus()">
          <i class="icon-refresh"></i>
          Régénérer les menus
        </button>
      </div>
    </div>
  </div>

  <!-- Barre de filtrage -->
  <div class="filter-bar">
    <label for="regimeFilter">Filtrer par type de régime :</label>
    <select id="regimeFilter" (change)="onRegimeTypeChange($event)">
      <option value="ALL">Tous les régimes</option>
      <option *ngFor="let type of regimeTypes" [value]="type">{{ type }}</option>
    </select>
  </div>

  <!-- Loading Spinner -->
  <div *ngIf="isLoading" class="loading-overlay">
    <div class="spinner"></div>
  </div>

  <!-- Error Message -->
  <div *ngIf="errorMessage" class="error-banner">
    <p>{{ errorMessage }}</p>
  </div>

  <!-- Menus Grid -->
  <div class="menus-grid" *ngIf="filteredMenus.length > 0">
    <div 
      *ngFor="let menu of filteredMenus" 
      class="menu-card"
      [ngClass]="{'menu-card-pending': !menu.isValidated}">
      
      <div class="menu-card-header">
        <div class="menu-date">
          <i class="icon-calendar"></i>
          {{ menu.date | date: 'dd/MM/yyyy' }}
        </div>
        <div class="menu-regime">
          <span class="badge">{{ menu.regime }}</span>
        </div>
      </div>

      <div class="menu-card-body">
        <div class="menu-dishes">
          <h3>Menu du jour</h3>
          <ul>
            <li *ngFor="let plat of menu.plats">
              {{ plat.nom }}
            </li>
          </ul>
        </div>

        <div class="menu-stats">
          <div class="calories-stat">
            <span 
              class="calories-label"
              [ngClass]="{
                'calories-low': menu.totalCalories < 2000,
                'calories-medium': menu.totalCalories >= 2000 && menu.totalCalories < 2500,
                'calories-high': menu.totalCalories >= 2500
              }">
              {{ menu.totalCalories }} kcal
            </span>
          </div>

          <div class="validation-status">
            <span 
    [ngClass]="{
      'status-validated': menu.isValidated,
      'status-pending': !menu.isValidated && !isRejected(menu.id),
      'status-rejected': !menu.isValidated && isRejected(menu.id)
    }">
    {{ menu.isValidated ? 'Validé' : (isRejected(menu.id) ? 'Rejeté' : 'En attente') }}
  </span>
          </div>
        </div>
      </div>

      <div class="menu-card-footer">
        <button 
          *ngIf="!menu.isValidated && canValidateMenus()" 
          class="btn btn-validate"
          (click)="validateMenus([menu.id])">
          Valider le menu
        </button>
        <button 
    *ngIf="!menu.isValidated && !isRejected(menu.id) && canValidateMenus()" 
    class="btn btn-reject"
    (click)="rejectMenus([menu.id])">
    Rejeter le menu
  </button>
      </div>
    </div>
  </div>

  <!-- Empty State -->
  <div *ngIf="filteredMenus.length === 0" class="empty-state">
    <i class="icon-empty-menu"></i>
    <h2>Aucun menu disponible</h2>
    <p>Commencez par générer des menus personnalisés</p>
    <button 
      class="btn btn-generate" 
      (click)="generateMenus()"
      [disabled]="!canGenerateMenus()">
      Générer des menus
    </button>
  </div>
</div>